<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Jeraine IT Department</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    body {
      font-family: "Arial", serif;
      color: #000;
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.2;
    }
    h3 {
      text-align: center;
      text-decoration: underline;
      font-weight: bold;
      margin-bottom: 30px;
    }
    p {
      text-align: justify;
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    td {
      padding: 4px;
      vertical-align: top;
    }
    .checkbox {
      display: inline-block;
      width: 15px;
      height: 15px;
      border: 1px solid #000;
      margin-right: 8px;
    }
    .filled {
      background-color: #000 !important;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    .underline {
      display: inline-block;
      border-bottom: 1px solid #000;
      min-width: 150px;
      text-align: center;
      padding: 0 5px;
    }
    .file-section {
      border: 1px solid #000;
    }
    .file-section td {
      border: 1px solid #000;
      padding: 6px;
    }
    .signature {
      margin-top: 60px;
      text-align: right;
      margin-right: 20px;
    }
    .signature-line {
      border-top: 1px solid #000;
      width: 200px;
      margin-left: auto;
      padding-top: 5px;
      text-align: center;
    }
    .controls {
      text-align: center;
      margin-bottom: 25px;
    }
    button {
      background-color: #004c91;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      padding: 10px 16px;
      font-size: 15px;
      margin: 5px;
    }
    button:hover {
      background-color: #00386d;
    }
    @media print {
      .controls, header, .note {
        display: none !important;
      }
      .filled {
        background-color: #000 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
    .cic-header {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 10px;
      gap: 20px;
    }
    .cic-logo {
      width: 400px;
      height: auto;
    }
    .cic-info {
      font-family: "Arial", sans-serif;
      line-height: 1.3;
    }
    .cic-info p {
      font-size: 13px;
      margin: 2px 0 0 0;
      color: #333;
    }
    table.Subject, table.Contract {
      margin-left: auto;
      margin-right: auto;
      width: 80%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    table.Subject td, table.Contract td {
      padding: 6px 10px;
      vertical-align: middle;
    }
    table.Subject td:nth-child(1), table.Contract td:nth-child(1) {
      width: 50%;
    }
    table.Subject td:nth-child(2), table.Contract td:nth-child(2) {
      width: 10%;
    }
    table.Subject td:nth-child(3), table.Contract td:nth-child(3) {
      width: 40%;
      text-align: center;
    }
    .btn {
      background-color: #004c91;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 16px;
      margin: 5px;
      font-size: 15px;
      cursor: pointer;
      display: inline-block;
      text-decoration: none;
      transition: all 0.2s ease;
      font-family: "Arial", sans-serif;
    }
    .btn:hover {
      background-color: #00386d;
      transform: translateY(-1px);
    }
    .btn:active {
      background-color: #002f59;
    }
    input[type="file"] {
      display: none;
    }
    #folderName {
      border: none;
      border-radius: 5px;
      padding: 10px 14px;
      margin: 5px;
      font-size: 15px;
      text-align: center;
      background-color: #004c91;
      color: white;
      font-family: "Arial", sans-serif;
      width: 200px;
      box-sizing: border-box;
    }
    #folderName::placeholder {
      color: #ddd;
    }
    #folderName:focus {
      outline: none;
      background-color: #00386d;
    }
</style>
</head>
<body>
	<div class="controls">
		<input type="text" id="folderName" placeholder="üìÅ Enter Folder Name" />
		<label for="fileInput" class="btn" id="chooseFileBtn">üìÑ Choose File</label>
		<input type="file" id="fileInput" accept=".xlsx, .xls, .csv">
		<button class="btn" onclick="window.print()">üñ®Ô∏è Print Transmittal Letter</button>
	</div>

	<div class="cic-header">
		<img src="CIC Logo.png" alt="CIC Logo" class="cic-logo">
		<div class="cic-info">
			<p>
				6F Exchange Corner Building<br>
				107 V. A. Rufino Street corner Esteban St.,<br>
				Legaspi Village, Makati City 1229<br>
				(02) 893-7159 | www.creditinfo.gov.ph
			</p>
		</div>
	</div>

	<h3>TRANSMITTAL LETTER</h3>

	<p>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is to confirm that <strong><i><u>Public Safety Mutual Benefit Fund, Inc.</u></i></strong> has successfully uploaded to the FTP Server of the
		<strong>Credit Information Corporation</strong> on 
		<span class="underline" id="uploadDate"></span> the contribution data covering the period
		<span class="underline" id="refPeriod"></span>.
	</p>

	<p>
		&nbsp;&nbsp;&nbsp;&nbsp;Records transmitted are composed of the following: (check the applicable box and indicate the corresponding quantity)
	</p>

	<table class="Subject">
		<tr><td><strong><u>Subject</u></strong></td><td></td><td></td></tr>
		<tr><td><div class="checkbox filled"></div> Individual</td><td><span class="underline" id="idCount"></span></td></tr>
		<tr><td><div class="checkbox"></div> Company</td><td><span class="underline"></span></td></tr>
	</table>

	<table class="Contract">
		<tr><td><strong><u>Contract</u></strong></td><td></td><td></td></tr>
		<tr><td><div class="checkbox filled"></div> Installment</td><td><span class="underline" id="ciCount"></span></td></tr>
		<tr><td><div class="checkbox"></div> Non-installment</td><td><span class="underline"></span></td></tr>
		<tr><td><div class="checkbox"></div> Credit Card</td><td><span class="underline"></span></td></tr>
		<tr><td><div class="checkbox"></div> Utility / Services</td><td><span class="underline"></span></td></tr>
	</table>

	<table>
		<tr>
		  <td><div class="checkbox filled"></div> REGULAR MONTHLY SUBMISSION / HISTORICAL DATA</td>
		  <td><div class="checkbox"></div> CORRECTION FILE FOR THE MONTH OF _________________</td>
		</tr>
	</table>

	<i>Please indicate the File Name and the Reference Date inside the contribution file.</i>

	<table class="file-section">
		<tr><td><strong>FILE NAME</strong></td><td><span id="fileName">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
		<tr><td><strong>FILE REFERENCE DATE</strong></td><td><span id="fileRef"></span></td></tr>
	</table>

	<div class="signature">
		<div class="signature-line">
		  MALECAH M. BARING
		  <div>Authorized Representative</div>
		</div><br><br>
		<div class="signature-line">
			<div>Date</div>
		</div>
	</div>

<script>
	document.getElementById("chooseFileBtn").addEventListener("click", function (event) {
		const folderInput = document.getElementById("folderName");
		const folderName = folderInput.value.trim();

		if (!folderName) {
		alert("Please enter a folder name first before selecting a file.");
		folderInput.focus();
		event.preventDefault();
		} else {
		folderInput.value = folderName.toUpperCase();
		}
	});

	document.getElementById("fileInput").addEventListener("change", function (event) {
		const file = event.target.files[0];
		const folderInput = document.getElementById("folderName");
		const folderName = folderInput.value.trim().toUpperCase();

		if (!file || !folderName) return;

	folderName = folderName.toUpperCase();

	  const baseName = file.name.replace(/\.[^/.]+$/, "");
	  document.getElementById("fileName").textContent = `${baseName}.zip.gpg`;

	  document.getElementById("refPeriod").textContent = folderName;
	  document.getElementById("fileRef").textContent = folderName;

	  const lastModifiedDate = new Date(file.lastModified);
	  document.getElementById("uploadDate").textContent =
		lastModifiedDate.toLocaleDateString("en-US", {
		  month: "long",
		  day: "numeric",
		  year: "numeric"
		});
		countIDandCI(file);
	});

	function countIDandCI(file) {
		const reader = new FileReader();
		reader.onload = function (e) {
		const data = e.target.result;
		let rows = [];

    if (file.name.endsWith(".csv")) {
      rows = data.split(/\r?\n/).map(r => r.split(",").map(v => v.trim()));
    } else {
      const arr = new Uint8Array(e.target.result);
      const workbook = XLSX.read(arr, { type: "array" });
      const sheetName = workbook.SheetNames[0];
      const sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], { header: 1 });
      rows = sheet;
    }

    let idCount = 0, ciCount = 0;
    rows.forEach(row => {
      if (!row[0]) return;
      const val = row[0].toString().trim().toUpperCase();
      if (val === "ID") idCount++;
      if (val === "CI") ciCount++;
    });

    document.getElementById("idCount").textContent = idCount.toLocaleString();
    document.getElementById("ciCount").textContent = ciCount.toLocaleString();
	};

	if (file.name.endsWith(".csv")) reader.readAsText(file);
	else reader.readAsArrayBuffer(file);
	}
</script>
</body>
</html>

